\section{Risk Parity}

Markowitzâ€™s portfolio has never been fully embraced by practitioners, among other reasons because it only considers the risk of the portfolio as a whole and ignores the risk diversification (i.e., concentrates risk too much in few assets, this was observed in the 2008 financial crisis): one solution is the risk parity portfolio.

Risk parity is an approach to portfolio management that focuses on allocation of risk rather than allocation of capital. The risk parity approach asserts that when asset allocations are adjusted to the same risk level, the portfolio can achieve a higher Sharpe ratio and can be more resistant to market downturns.

While the minimum variance portfolio tries to minimize the variance (with the disadvantage that a few assets may be the ones contributing most to the risk), the risk parity portfolio distributes the weights so that the risk contribution of each asset (or asset class, such as bonds, stocks, real estate, etc.) is the same.

To define a risk-based allocation strategies it is necessary define how the risk of an asset affects the risk of the portfolio. 
Let $x^\top=(x_1,x_2,\dots,x_n)$ be a portfolio with $n$ assets and $\mathcal{R}(x)$ be a differentiable, homogeneous risk measure of $x$. Since $\mathcal{R}(x)$ is homogeneous, we have
\[
\mathcal{R}(x)=\frac{d}{d\lambda}\mathcal{R}(\lambda x)=\sum_{i=1}^n x_i \frac{\partial \mathcal{R} (x)}{\partial x_i}
\]
we can define the risk contribution of the asset $i$ by
$\mathcal{RC}_i$, where
\[
\mathcal{RC}_i(x)= x_i \frac{\partial \mathcal{R}(x)}{\partial x_i}.
\]
Therefore, the risk can be written as follows
\[
\mathcal{R}(x)=\sum_{i=1}^n \mathcal{RC}_i(x)
\]
which is known as \textbf{Euler's Allocation Principle}.

Volatility and $\mbox{CVaR}_\beta$  satisfy the properties required by the risk measure, $\mathcal{R}$, defined above. However, $\mbox{VaR}_\beta$ satisfies these properties only in the Gaussian case. When asset returns have a Normal Distribution, by simplicity (see Remark \ref{re:Normal}), we have that
$\mathcal{R}(x)=\sigma(x)=\sqrt{x^\top\Sigma x}$, it follows that
\[
\mathcal{RC}_i(x)= x_i \frac{\partial \sigma(x)}{\partial x_i}=\frac{x_i (\Sigma x)_i}{\sqrt{x^\top\Sigma x }}.
\]

It may be interesting for the investor to choose different risks for different assets, in this case the investor choose the percentage of risk that each asset should have in the portfolio, that is,
\begin{equation}\label{eq:RBP}
	\mathcal{RC}_i(x)=b_i\mathcal{R}(x),
\end{equation}
where $b_i$ represents the risk contribution that asset $i$ will have in the portfolio. Certainly $b_i\geq 0$ for all $i$ and
${\bf 1}^\top b =1$, with $b=(b_1, b_2, \dots, b_n)$. A portfolio distribution based in relation \eqref{eq:RBP} is called \textit{risk budgeting portfolio} (RBP), when $b_i=1/n$, for all $i$ the distribution is called \textit{risk parity portfolio} (RPP) or \textit{equal risk portfolio} (ERP).

In general, find the risk budgeting portfolio consists to solve the following non-linear system
\begin{eqnarray}\label{eq:SisNLin}
\mathcal{RC}_i(x)=b_i\mathcal{R}(x), \\
	\mbox{s.t. }\left\{
	\begin{aligned}\nonumber
b_i \geq 0, \\
x_i \geq 0, \\
{\bf 1}^\top b =1, \\
{\bf 1}^\top x =1.
	\end{aligned}
	\right.
\end{eqnarray}











Only in trivial cases can we find analytical solutions for this system, however, we can always find numerical solutions.

Consider $b^\top = (b_1, b_2, \dots, b_n)$, with ${\bf 1}^\top b =1$ and $f(x;b)$ defined by:
\[
f(x;b) = \sum_{i=1}^n \big(\mathcal{RC}_i(x) -b_i\mathcal{R}(x)\Big)^2
\] and the following optimization problem
\begin{eqnarray}\label{eq:MinProb}
\min_{x\geq \textbf{0}}\, \{f(x;b)\}; \\
	\mbox{s.t. }\left\{
	\begin{aligned}\nonumber
		\mathbf{1}^\top x=1 & \\
		\mathbf{0}\leq x \leq \mathbf{1}
	\end{aligned}
	\right.
\end{eqnarray}

If $x^\star$ is the solution to the problem (\ref{eq:MinProb}) and
$f(x^\star;b)=0$, so $x^\star$ is also system solution
(\ref{eq:SisNLin}). So we can use some optimization algorithm
quadratic to find a solution to the PDR. as it was
said before, to find a PPR just choose $b_i=1/n$, in the
process of choosing a PDR.

In the Gaussian case, when asset returns have a Normal distribution, we can consider $\mathcal{R}(x)=\sigma(x)$ and the system (\ref{eq:SisNLin}) reduces to
\begin{eqnarray}\label{eq:SisGauss}
x_i (\Sigma x )_i = b_i x^\top \Sigma x,\\
	\mbox{s.t. }\left\{
	\begin{aligned}\nonumber
b_i \geq 0, \\
x_i \geq 0, \\
{\bf 1}^\top b =1, \\
{\bf 1}^\top x =1.
	\end{aligned}
	\right.
\end{eqnarray}
for $i=1,2,\dots,n$.


Setting $w=x/\sqrt{x^\top \Sigma x}$, the equation $x_i (\Sigma x )_i = b_i x^\top \Sigma x$ is equivalent to $w_i(\Sigma w)_i =b_i$, or, in vector form
\[
\Sigma w = b/w.
\]

In 2013, Spinu (see in \cite{Spinu2013}) showed that the convex function
\[
f(w)= \frac{1}{2}w^\top \Sigma w - b^\top log(w)
\]
has a gradient equal to
\[
\nabla f(w) = \Sigma w - b/w
\]
and the system (\ref{eq:SisGauss}) can be reformulated by the following optimization problem
\begin{eqnarray}\label{eq:GaussProb}
\min_{x\geq {\bf 0}}\,\Big\{\frac{1}{2}w^\top \Sigma w - b^\top \log(w)\Big\};  \\
	\mbox{s.t. }\left\{
	\begin{aligned}\nonumber
		\mathbf{1}^\top x=1 & \\
		\mathbf{0}\leq x \leq \mathbf{1}
	\end{aligned}
	\right.
\end{eqnarray}


whose optimality condition is $\nabla f(w) = 0$ or $\Sigma w = b/w$ which is precisely the solution of the system (\ref{eq:SisGauss}).



